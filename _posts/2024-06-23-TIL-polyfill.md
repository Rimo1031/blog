---
title: "JavaScript에서의 폴리필"
excerpt: " "
categories:
  - Programming Language
tags:
  - [JavaScript]
toc: true
toc_sticky: true
# last_modified_at : 2022-04-12T00:30:00
---

웹 개발을 하다 보면 가끔 "폴리필 (polyfill)"이라는 용어를 마주칠 때가 있다. 흔하게 볼 수 있는 용어는 아니지만, 가끔 IE와 같은 구버전 브라우저와의 호환성을 보장해야 할 때 만나게 될 용어이다. 오늘은 이 폴리필에 대해 알아보려고 한다.

## JavaScript의 표준

Python에도 2.0, 3.0 등의 버전이 있고, Java에도 여러 버전이 있는 것처럼 JavaScript에도 버전과 그에 맞는 표준이 있다. JavaScript의 표준은 Ecma International이라는 기관에서 제정하는데, 이 기관에서는 ECMA-262라는 기술 규격을 만들고 이 규격을 준수하는 스크립트 언어의 사양을 가이드북과 같이 제공한다. 이를 ECMAScript라고 하며 줄여서 ES라고 자주 부른다. 자바스크립트 관련 자료를 찾아보다 보면 자주 마주칠 수 있는 ES5, ES6과 같은 것들이 이 ECMAScript의 버전을 말하는 것이다. 현재 가장 대중적으로 사용되는 버전은 ES6 (ES2015)이고, `let`, `const` 등의 변수 선언 키워드와 `() => {}`와 같은 arrow function 문법이 이 때 추가되었다.

## 표준만 업데이트해서는 아무것도 할 수 없다.

Ecma International에서 ECMAScript의 버전을 업데이트하고 이를 발표하면 그 즉시 전 세계의 사용자가 업데이트된 버전을 즉시 사용할 수 있을까? 어찌 보면 당연하겠지만 이러한 일은 일어나기 어렵다. 자바스크립트는 단순한 언어에 불과하고, 이 자바스크립트를 실행시켜 주는 **엔진**이 업데이트된 ES 스펙을 이해하지 못한다면 아무리 최신 ES 버전을 적용해 코드를 작성해도 실행시킬 수 없을 것이다.

JavaScript로 작성된 코드를 실행하기 위해서는 자바스크립트 엔진이 필요하다. 자바스크립트는 주로 브라우저에서 실행되므로 자연스럽게 주요 자바스크립트 엔진의 개발사도 메이저 브라우저의 개발사와 엇비슷하다. 대표적인 자바스크립트 엔진으로는 구글의 V8, 애플의 WebKit, 모질라의 SpiderMonkey 등이 있는데, 당연하게도 각각 크롬, 사파리, 파이어폭스에 사용되는 엔진이다. 자바스크립트 코드를 실제로 실행하는 주체가 이 엔진이기 때문에, ES 스펙이 업데이트되면 엔진 개발사에서 엔진이 최신 스펙의 ES를 실행할 수 있도록 업데이트해 주어야 한다. 물론 이 업데이트까지 걸리는 시간은 엔진 개발사마다 모두 다르고, 최악의 상황에서 엔진 자체의 업데이트가 끊겨 버린다면 그 엔진은 영원히 구버전의 ES 스펙만을 구현한 채로 남게 된다.

## 폴리필?

폴리필은 이렇게 자바스크립트 엔진별로 지원하는 ES 버전이 다른 상황에서 **코드의 하위 호환성을 보장하기 위해** 만들어졌다. 최근 대부분의 자바스크립트 코드가 컴파일되는 시점에는 Babel이라고 부르는 트랜스파일러 (transpiler)가 동작한다. Babel은 최신 ES에서 추가된 **문법**을 구버전 ES와 호환되게 번역하는 역할을 담당하고 있다. Babel을 통해 문법을 변환할 수는 있지만, 새로운 ES 스펙에 없던 함수가 추가되었거나 하면 단순히 문법만 번역하는 Babel만으로는 대응이 어렵다. 이를 위해 도입된 것이 polyfill으로, **최신 ES에서 추가된 함수 스펙을 구버전 ES 스펙만 가지고 따로 구현한 것**이다. 즉, 구버전 ES에 없는 최신 ES 스펙을 별도로 구현한 것이다. 예를 들어, `map()`이나 `reduce()` 함수 같은 경우는 ES6에서 추가된 함수이므로 ES5 이하 버전만을 지원하는 자바스크립트 엔진에서는 별도 처리가 없으면 실행이 불가능하다. 이들 엔진을 위해 ES5 이하 스펙에서 `map()` 함수와 같은 동작을 하는 함수를 폴리필로 추가하면, ES5 이하의 자바스크립트 엔진에서도 ES6에 포함된 `map()` 함수를 사용할 수 있게 되는 것이다.

앞서 소개한 Babel과 폴리필은 다양한 환경에서의 웹 브라우징을 지원하기 위해서는 사실상 필수와 같기 때문에, webpack과 같은 번들러를 사용하면 별도 설정 없이, 또는 간단한 설정만으로 기본적으로 적용할 수 있다.